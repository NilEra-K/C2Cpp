# Day 03

**左值和右值** <p>
大多数人认为 **左值是 "=" 左边的值, 右值是 "=" 右边的值** , 实际上这是一个错误的认知, **"=" 左边的为左操作数, "=" 右边的为右操作数**
- **左值 :** 能够取地址的就叫 *左值*
- **右值 :** 不能取地址的就叫 *右值*

**指针的补充 (了解)** <p>
定义函数时, 一个函数的形参表只有 `int` , 一个函数的形参表只有`const int` , 会报重定义错误 —— <p> 
C++ 不太区分变量本身的常属性, 即 `const int` 和 `int` 多数情况下是一致的 <p>
而指针不同, 如 `const char* p` , `const` 修饰的不是指针的本身, 而是指针的目标, 也就是 `p` , 即 `const char* p` 和 `char* q` 是完全不同的  <p>
但是 `char* const p` 和 `char* q` 则类型相同

**引用**
- 引用即内存的别名
    ```
    int a = 10;
    int& b = a;
    ```
- 引用本身**不占内存, 并非实体 _(在 C++ 的层面来讲)_ , 但是在汇编角度来讲, 其占内存, 且为实体**, 对引用的所有操作都是再对目标内存进行操作
- 引用必须初始化, 且不能更换目标
    ```
    int c = 20;
    b = c;  // 仅仅是在对引用的目标内存进行
    ```
- 不存在引用的引用, 即 `&&`
    ```
    int a = 10;
    int& b = a;
    int& d = b; // 理解为 d 和 b 都是 a 的别名
    ```
- 引用的常属性必须和目标的常属性一致(或更严格限定)
    ```
    const int e = 10;
    int& f = e;         // [Error]
    const int& g = e;   // [OK]
    ```
- 可以限定更加严格
    ```
    int a = 10;
    const int& h = a;   // [OK]
    ```
- 引用可以延长右值的生命周期
- 常引用即**万能引用(可以引用常左值、非常左值、右值)**, 但是如果常引用引用的为非常左值, 通过别名将丧失修改其目标内存的权限
    ```
    int a = 10;
    const int& b = a;   
    b = 10; // [Error] 使用万能引用将无法修改非常左值的内存
    ```
- 引用的生命周期不能长于目标

**值传递** <p>
C语言中, 只要涉及到数据的传递 (例如: 初始化、赋值、传参、返回值), 都是值传递 (将数据复制一份给别人)
```
// 初始化, 将无名内存里的数据复制一份初始化给 a
int a = 10;

// 赋值, 将无名内存里的数据复制一份赋值给 a
a = 20;

// 传参, 将 a中的数据复制一份保存到 x内存
void function(int x){ ... }
foo(a);

// 返回值
// 将 m中的数据复制一份, 保存到调用处的无名内存处
int bar(){
    int m = 10;
    return m;
}
bar();

```
C++ 中因为有了引用这个特性, 所以在 C++程序中可以不做值传递


**引用的应用** <p>
- 引用型参数: 函数的形参是实参的别名, 避免对象复制带来的开销
    - 非常引用型参数: 
        - 可以在函数内部直接修改实参值
    - 常引用型参数:
        - 防止对实参的意外修改
        - 接收常量型实参
- 引用型返回值: 从函数中返回引用, 一定要保证在函数返回以后, 该引用的目标依然有效
    - 可以返回 *全局、静态变量* 的引用
    - 可以返回 *成员变量* 的引用
    - 可以返回在 *堆中动态创建* 的对象的引用
    - 可以返回 *调用对象自身* 的引用
    - 可以返回 *引用型参数* 本身
    - **不能**返回 *局部变量* 的引用
- 非常引用型返回值
    - 通过引用可以修改目标
- 常引用型返回值
    - 通过引用不能修改目标

**引用小结** <p>
在实现层面, 引用就是指针, 但在 C++语言层面, 引用不是实体类型, 因此 C++语言层面引用与指针存在**明显的区别**
- 指针可以不初始化, 但**引用必须初始化**
- 指针的目标可在初始化后随意变更(除非是指针变量), 而引用一旦初始化就**无法**变更其目标
- 存在空指针, 但是**不存在空引用**
- 存在指向指针的指针, **不存在引用的引用**
- 存在指向指针的引用, **不存在引用的指针**
- 存在指针数组, **不存在引用数组, 但存在数组引用**



