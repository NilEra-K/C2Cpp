# Day 08

**友元**
- 可以通过 `friend` 关键字, 把一个全局函数、另一个类的成员函数或者另一个类整体, 声明为授权类的 **友元**
- 友元拥有访问授权类任何非共有成员的特权
- 友元声明可以出现在授权类的公有、私有或者保护等任何区域, 其不受访问控制限定符的约束
- 友元不是成员, 其作用域不隶属于授权类, 也不拥有授权类类型的 **this 指针**

**操作符重载** <p>
重新定义操作符的运算规则, 一旦重新定义了操作符的规则, 可以使我们自己设计的类型和基本类型一样参与各种运算符的表达式 <p>
例如: 
```
int a = 5, b = 10;
a + b;  // 基本类型, 编译器本身知道按照什么规则做加法

Human ha, hb;
ha + hb;// 自定义类型, 编译器本身不知道按照什么规则做加法, 规则需要由我们来定制
```

**操作符标记与操作符函数**
- 操作符标记
    - **单目运算符 :** `-` 、 `++` 、 `--` 、 `*` 、 `->` 等
    - **双目运算符 :** `+` 、 `-` 、`>` 、 `<` 、 `+=` 、 `-=` 、 `>>` 、 `<<` 等
    - **三目运算符 :** `? :`
- 操作符函数
    - 在特定条件下, 编译器有能力把一个由操作数和操作符组成的表达式, 解释为对一个全局函数的调用或解释为对一个成员函数的调用, 该全局函数或成员函数被称为操作符函数
        ```
        a + b; -> a.operator+(b) 或 a.operator+(a, b)

        a - b; -> a.operator-(b) 或 a.operator-(a, b)
        ```
    - 通过定义操作符函数, 可以实现针对自定义类型的运算法则, 并使之与内置类型一样参与各种表达式
- 单目操作符表达式(`O`为唯一操作数, `#`为操作符): `#O` / `O#`
    - **成员函数形式 :** `O.operator#()`
    - **全局函数形式 :** `operator#(O)`
- 双目操作符表达式(`L`为左操作数、`R`为右操作数、`#`为操作符): `L # R`
    - **成员函数形式 :** `L.operator#(R)` <p>
      左操作数是调用对象, 右操作数是参数对象
    - **全局函数形式 :** `operator#(L, R)` <p>
      左操作数是第一参数, 右操作数是第二参数
- 三目操作符表达式: F # S # T
    - 无法重载
- **[注意] 成员函数形式和全局函数形式两个只需要提供一个, 否则编译器会报错**

***典型单目操作符重载***
- 运算类单目操作符: **`-` (数值反)** 、 **`~` (按位反)** 、 **`!` (逻辑反)**
    - 操作数可以为**非常左值**、 **常左值** 或 **右值**
    - 表达式结果为右值
- 前自增减类单目操作符: **`++x`** 、 **`--x`**
    - 操作数为非常左值
    - 表达式的结果为**操作数本身**, 而非副本
- 后自增减类单目操作符: **`x++`** 、 **`x--`**
    - 操作数为非常左值
    - 表达式的结果为**右值** , **且为自增减以前的值**
- **在 C 中** , 前++: 先加 1, 再使用; 后++: 先使用, 再加 1 <p>
  **在 C++ 中** , 前++ 和 后++ 都是直接加 1(内部实现和 C 并不相同), 但是 C++ 想让用户感觉 C一样

***典型双目操作符重载***
- 运算类双目操作符: `+`、 `-`、 `*`、 `/`
    - 左右操作数均可以为**非常左值**、 **常左值** 或 **右值**
    - 表达式结果为**右值**
- 赋值类双目操作符: `=`、 `+=`、 `-=`、 `*=`、 `/=`
    - 右操作数可以为**非常左值**、 **常左值** 或 **右值** , 但左操作数必须为非常左值
    - 表达式结构为左操作数本身(而非副本)
- 比较类双目操作符: `>`、 `<`、 `==`、 `<=`、 `>=` 等
    - 左右操作数均可以为**非常左值**、 **常左值** 或 **右值**
    - 表达式结果为 `bool`

***输入输出操作符的重载***
- 输出操作符: `<<`
    - 左操作数为**非常左值**形式的输出流 **(`ostream`)** 对象, 右操作数为左值或右值
    - 表达式的结果为左操作数本身, 而非副本
    - 左操作数的类型为 `ostream` , 若以成员函数形式重载该操作符, 就应将其定义为 `ostream` 类的成员, 该类为标准库提供, 无法添加新的成员, 因此**只能以全局函数形式重载**该操作符
        ```
        ostream& operator<<(ostream& os, const RIGHT& right) { ... }
        ```
- 输入操作符: `>>`
    - 左操作符为**非常左值**形式的输入流 **(`istream`)** 对象, 右操作数为非常左值
    - 表达式的结果为左操作数本身, 而非副本
    - 左操作数的类型为 `istream` , 若以成员函数形式重载该操作符, 就应将其定义为 `istream` 类的成员, 该类为标准库提供, 无法添加新的成员, 因此**只能以全局函数形式重载**该操作符
        ```
        istream& operator>>(istream& is, RIGHT& right) { ... }
        ```

***下标操作符***
- 下标操作符: `[]`
    - 常用于在容器类型中以下标方式获取数据元素
    - 非常容器的元素为非常左值, 常容器的元素为常左值


